#ifndef MAX7219_H
#define MAX7219_H

#include "esp_err.h"

#define CS_PIN GPIO_NUM_10

esp_err_t init_spi();
void test_draw(char *d);

typedef struct {
    char c;
    uint8_t rows[8];
} font8x8_t;

typedef struct {
    char c;
    uint8_t rows[4];  // only 4 rows, lower 4 bits used
} font4x4_t;

static const font8x8_t font8x8[] = {
    
    // Letters A-Z
    {'A', {0x18,0x24,0x42,0x7E,0x42,0x42,0x42,0x00}}, // A ,0
    {'B', {0x7C,0x42,0x42,0x7C,0x42,0x42,0x7C,0x00}}, // B, 1
    {'C', {0x3C,0x42,0x40,0x40,0x40,0x42,0x3C,0x00}}, // C, 2
    {'D', {0x78,0x44,0x42,0x42,0x42,0x44,0x78,0x00}}, // D, 3
    {'E', {0x7E,0x40,0x40,0x7C,0x40,0x40,0x7E,0x00}}, // E, 4
    {'F', {0x7E,0x40,0x40,0x7C,0x40,0x40,0x40,0x00}}, // F, 5
    {'G', {0x3C,0x42,0x40,0x4E,0x42,0x42,0x3E,0x00}}, // G. 6
    {'H', {0x42,0x42,0x42,0x7E,0x42,0x42,0x42,0x00}}, // H, 7
    {'I', {0x7E,0x18,0x18,0x18,0x18,0x18,0x7E,0x00}}, // I, 8
    {'J', {0x7E,0x04,0x04,0x04,0x04,0x44,0x38,0x00}}, // J, 9
    {'K', {0x42,0x44,0x48,0x70,0x48,0x44,0x42,0x00}}, // K
    {'L', {0x40,0x40,0x40,0x40,0x40,0x40,0x7E,0x00}}, // L
    {'M', {0x42,0x66,0x5A,0x5A,0x42,0x42,0x42,0x00}}, // M
    {'N', {0x42,0x62,0x52,0x4A,0x46,0x42,0x42,0x00}}, // N
    {'O', {0x3C,0x42,0x42,0x42,0x42,0x42,0x3C,0x00}}, // O
    {'P', {0x7C,0x42,0x42,0x7C,0x40,0x40,0x40,0x00}}, // P
    {'Q', {0x3C,0x42,0x42,0x42,0x52,0x4C,0x36,0x00}}, // Q
    {'R', {0x7C,0x42,0x42,0x7C,0x48,0x44,0x42,0x00}}, // R
    {'S', {0x3E,0x40,0x40,0x3C,0x02,0x02,0x7C,0x00}}, // S
    {'T', {0x7E,0x18,0x18,0x18,0x18,0x18,0x18,0x00}}, // T
    {'U', {0x42,0x42,0x42,0x42,0x42,0x42,0x3C,0x00}}, // U
    {'V', {0x42,0x42,0x42,0x24,0x24,0x18,0x18,0x00}}, // V
    {'W', {0x42,0x42,0x42,0x5A,0x5A,0x66,0x42,0x00}}, // W
    {'X', {0x42,0x24,0x18,0x18,0x18,0x24,0x42,0x00}}, // X
    {'Y', {0x42,0x24,0x18,0x18,0x18,0x18,0x18,0x00}}, // Y
    {'Z', {0x7E,0x02,0x04,0x18,0x20,0x40,0x7E,0x00}}, // Z

    // Numbers 0-9
    {'0',{0x3C,0x42,0x46,0x4A,0x52,0x62,0x3C,0x00}}, // 26
    {'1',{0x18,0x38,0x18,0x18,0x18,0x18,0x7E,0x00}},
    {'2',{0x3C,0x42,0x02,0x1C,0x20,0x40,0x7E,0x00}},
    {'3',{0x3C,0x42,0x02,0x1C,0x02,0x42,0x3C,0x00}},
    {'4',{0x04,0x0C,0x14,0x24,0x44,0x7E,0x04,0x00}}, // 30
    {'5',{0x7E,0x40,0x7C,0x02,0x02,0x42,0x3C,0x00}}, 
    {'6',{0x3C,0x40,0x7C,0x42,0x42,0x42,0x3C,0x00}},
    {'7',{0x7E,0x02,0x04,0x08,0x10,0x10,0x10,0x00}},
    {'8',{0x3C,0x42,0x42,0x3C,0x42,0x42,0x3C,0x00}},
    {'9',{0x3C,0x42,0x42,0x3E,0x02,0x42,0x3C,0x00}}, // 35

    // Symbol
    {' ', {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}}, // Clear
    {'+', {0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00}}, // 37
    {'-', {0x00,0x00,0x00,0x7E,0x00,0x00,0x00,0x00}},
    {'!', {0x18,0x18,0x18,0x18,0x18,0x00,0x18,0x00}}, // 39
    {'%', {0x62,0x64,0x08,0x10,0x26,0x46,0x00,0x00}},
    {':', {0x00,0x18,0x18,0x00,0x18,0x18,0x00,0x00}}, // 41
    // {'"', {0x36,0x36,0x00,0x00,0x00,0x00,0x00,0x00}},
    // {'\', {0x0C,0x0C,0x00,0x00,0x00,0x00,0x00,0x00}}, // 42
    // {'d', {0x1C,0x14,0x1C,0x00,0x00,0x00,0x00,0x00}}, 
};



static const font4x4_t font4x4[] = {
    // A-Z
    {'A',{0b0110,0b1001,0b1111,0b1001}},
    {'B',{0b1110,0b1001,0b1110,0b1001}},
    {'C',{0b0111,0b1000,0b1000,0b0111}},
    {'D',{0b1110,0b1001,0b1001,0b1110}},
    {'E',{0b1111,0b1000,0b1110,0b1000}},
    {'F',{0b1111,0b1000,0b1110,0b1000}},
    {'G',{0b0111,0b1000,0b1011,0b0111}},
    {'H',{0b1001,0b1001,0b1111,0b1001}},
    {'I',{0b1111,0b0100,0b0100,0b1111}},
    {'J',{0b0111,0b0010,0b0010,0b1100}},
    {'K',{0b1001,0b1010,0b1100,0b1010}},
    {'L',{0b1000,0b1000,0b1000,0b1111}},
    {'M',{0b1001,0b1111,0b1111,0b1001}},
    {'N',{0b1001,0b1101,0b1011,0b1001}},
    {'O',{0b0110,0b1001,0b1001,0b0110}},
    {'P',{0b1110,0b1001,0b1110,0b1000}},
    {'Q',{0b0110,0b1001,0b1011,0b0111}},
    {'R',{0b1110,0b1001,0b1110,0b1010}},
    {'S',{0b0111,0b1000,0b0110,0b1111}},
    {'T',{0b1111,0b0100,0b0100,0b0100}},
    {'U',{0b1001,0b1001,0b1001,0b0110}},
    {'V',{0b1001,0b1001,0b0110,0b0110}},
    {'W',{0b1001,0b1111,0b1111,0b1001}},
    {'X',{0b1001,0b0110,0b0110,0b1001}},
    {'Y',{0b1001,0b0110,0b0100,0b0100}},
    {'Z',{0b1111,0b0010,0b0100,0b1111}},

    // 0-9
    {'0',{0b0110,0b1001,0b1001,0b0110}},
    {'1',{0b0010,0b0110,0b0010,0b0010}},
    {'2',{0b0110,0b0001,0b0110,0b1000}},
    {'3',{0b0110,0b0001,0b0010,0b0110}},
    {'4',{0b1001,0b1001,0b1111,0b0001}},
    {'5',{0b1111,0b1000,0b1110,0b0001}},
    {'6',{0b0111,0b1000,0b1110,0b0111}},
    {'7',{0b1111,0b0001,0b0010,0b0100}},
    {'8',{0b0110,0b1001,0b0110,0b1001}},
    {'9',{0b0111,0b1001,0b0111,0b0001}},

    // Symbols
    {' ', {0b0000,0b0000,0b0000,0b0000}}, // Clear
    {'+', {0b0100,0b1110,0b0100,0b0000}},
    {'-', {0b0000,0b1110,0b0000,0b0000}},
    {'!', {0b0100,0b0100,0b0000,0b0100}},
    {':', {0b0000,0b0100,0b0000,0b0100}},
    // {'"', {0b1010,0b1010,0b0000,0b0000}},
    // {'\'',{0b0100,0b0100,0b0000,0b0000}},
    // {'d',{0b0110,0b0110,0b0000,0b0000}},
};


#endif